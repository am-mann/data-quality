import pandas as pd
import string
from pathlib import Path

# Generate 4-digit ICD-10 codes: A00.0 â€“ Z99.9
codes_4digit = []
for letter in string.ascii_uppercase:
    for num in range(100):
        for decimal in range(10):
            codes_4digit.append(f"{letter}{num:02d}.{decimal}")

# Build DataFrame with base codes
records_4digit = []
for code in codes_4digit:
    records_4digit.append({
        "icd10_code": code
    })

df_4 = pd.DataFrame(records_4digit)

nonspecific_full = {
    'I46.9', 'I46.0', 'I46' 'I46.1','I50', 'I10', 'I50.1', 'I50.9', 'J96.9', 'R54', 'R99', 'R96', 'R98', 'X59', 'A41.9', 'J18.9',
    'I64', 'E14.9', 'C80.9','C97','C76', 'I49.0', 'I47.2', 'I10', 'I51.4', 'I51.5', 'I51.7', 'I51.9',
    'J81', 'J18', 'J18.0', 'J18.1', 'J18.2', 'J18.8', 'J18.9', 'R09.2', 'D65', 'E86', 'R57.9', 'N17', 'N18', 'N19', 'W19', 'X44', 'X49',
    'Y34', 'Y10', 'Y11', 'Y12', 'Y13', 'Y14', 'Y15', 'Y16', 'Y17', 'Y18', 'Y19', 'F99', 'A41.9', 'D65', 'E86', 'X59',
    'Y34', 'F03', 'F99',  'A41.0', 'A41.1', 'A41.2', 'A41.3', 'A41.4', 'A41.5', 'A41.6', 'A41.7', 'A41.8',
    'C80.0', 'C80.1', 'C80.2', 'C80.3', 'C80.4', 'C80.5', 'C80.6', 'C80.7', 'C80.8',
    'E14.0', 'E14.1', 'E14.2', 'E14.3', 'E14.4', 'E14.5', 'E14.6', 'E14.7', 'E14.8',
    'I46.2', 'I46.3', 'I46.4', 'I46.5', 'I46.6', 'I46.7', 'I46.8',
    'I47.0', 'I47.1', 'I47.3', 'I47.4', 'I47.5', 'I47.6', 'I47.7', 'I47.8', 'I47.9',
    'I49.1', 'I49.2', 'I49.3', 'I49.4', 'I49.5', 'I49.6', 'I49.7', 'I49.8', 'I49.9',
    'I50.0', 'I50.2', 'I50.3', 'I50.4', 'I50.5', 'I50.6', 'I50.7', 'I50.8',
    'I51.0', 'I51.1', 'I51.2', 'I51.3', 'I51.6', 'I51.8',
    'J18.3', 'J18.4', 'J18.5', 'J18.6', 'J18.7',
    'J96.0', 'J96.1', 'J96.2', 'J96.3', 'J96.4', 'J96.5', 'J96.6', 'J96.7', 'J96.8',
    'N17.0', 'N17.1', 'N17.2', 'N17.3', 'N17.4', 'N17.5', 'N17.6', 'N17.7', 'N17.8', 'N17.9',
    'N18.0', 'N18.1', 'N18.2', 'N18.3', 'N18.4', 'N18.5', 'N18.6', 'N18.7', 'N18.8', 'N18.9',
    'N19.0', 'N19.1', 'N19.2', 'N19.3', 'N19.4', 'N19.5', 'N19.6', 'N19.7', 'N19.8', 'N19.9',
    'R09.0', 'R09.1', 'R09.3', 'R09.4', 'R09.5', 'R09.6', 'R09.7', 'R09.8', 'R09.9',
    'R96.0', 'R96.1', 'R96.2', 'R96.3', 'R96.4', 'R96.5', 'R96.6', 'R96.7', 'R96.8', 'R96.9',
    'R98.0', 'R98.1', 'R98.2', 'R98.3', 'R98.4', 'R98.5', 'R98.6', 'R98.7', 'R98.8', 'R98.9',
    'Y10.0', 'Y10.1', 'Y10.2', 'Y10.3', 'Y10.4', 'Y10.5', 'Y10.6', 'Y10.7', 'Y10.8', 'Y10.9',
    'Y11.0', 'Y11.1', 'Y11.2', 'Y11.3', 'Y11.4', 'Y11.5', 'Y11.6', 'Y11.7', 'Y11.8', 'Y11.9',
    'Y12.0', 'Y12.1', 'Y12.2', 'Y12.3', 'Y12.4', 'Y12.5', 'Y12.6', 'Y12.7', 'Y12.8', 'Y12.9',
    'Y13.0', 'Y13.1', 'Y13.2', 'Y13.3', 'Y13.4', 'Y13.5', 'Y13.6', 'Y13.7', 'Y13.8', 'Y13.9',
    'Y14.0', 'Y14.1', 'Y14.2', 'Y14.3', 'Y14.4', 'Y14.5', 'Y14.6', 'Y14.7', 'Y14.8', 'Y14.9',
    'Y15.0', 'Y15.1', 'Y15.2', 'Y15.3', 'Y15.4', 'Y15.5', 'Y15.6', 'Y15.7', 'Y15.8', 'Y15.9',
    'Y16.0', 'Y16.1', 'Y16.2', 'Y16.3', 'Y16.4', 'Y16.5', 'Y16.6', 'Y16.7', 'Y16.8', 'Y16.9',
    'Y17.0', 'Y17.1', 'Y17.2', 'Y17.3', 'Y17.4', 'Y17.5', 'Y17.6', 'Y17.7', 'Y17.8', 'Y17.9',
    'Y18.0', 'Y18.1', 'Y18.2', 'Y18.3', 'Y18.4', 'Y18.5', 'Y18.6', 'Y18.7', 'Y18.8', 'Y18.9',
    'Y19.0', 'Y19.1', 'Y19.2', 'Y19.3', 'Y19.4', 'Y19.5', 'Y19.6', 'Y19.7', 'Y19.8', 'Y19.9'
}

specific_full = {
    'I21.0', 'I21.1', 'I21.2', 'C34.1', 'C34.2', 'J44.1', 'E10.9', 'E11.9', 'G30.1',
    'I20.0', 'K70.3', 'F01.5', 'F03.9', 'I25.1', 'I11.0', 'I11.9', 'I13.0', 'I13.2',
    'I60.0', 'I61.0', 'I63.0', 'F01.0', 'J44.0', 'J44.9', 'J45.9', 'J84.10', 'J13',
    'J69.0', 'U07.1', 'A40.0', 'A41.0', 'A15.0', 'B20', 'C18.0', 'C25.9', 'C50.9',
    'C78.7', 'E11.21', 'E10.10', 'E66.9', 'E43', 'G31.0', 'G20', 'G12.2', 'F32.9',
    'F33.9', 'F10.2', 'F11.2', 'T40.1', 'W01', 'W10.9', 'V87.7', 'X42', 'X60', 'X85',
    'Y87.1', 'Y83.2', 'A40.1', 'A40.2', 'A40.3', 'A40.4', 'A40.5', 'A40.6', 'A40.7', 'A40.8', 'A40.9',
    'A41.1', 'A41.2', 'A41.3', 'A41.4', 'A41.5', 'A41.6', 'A41.7', 'A41.8', 'A41.9',
    'C18.1', 'C18.2', 'C18.3', 'C18.4', 'C18.5', 'C18.6', 'C18.7', 'C18.8', 'C18.9',
    'C25.0', 'C25.1', 'C25.2', 'C25.3', 'C25.4', 'C25.5', 'C25.6', 'C25.7', 'C25.8',
    'C34.0', 'C34.3', 'C34.4', 'C34.5', 'C34.6', 'C34.7', 'C34.8', 'C34.9',
    'C50.0', 'C50.1', 'C50.2', 'C50.3', 'C50.4', 'C50.5', 'C50.6', 'C50.7', 'C50.8',
    'E10.0', 'E10.1', 'E10.2', 'E10.3', 'E10.4', 'E10.5', 'E10.6', 'E10.7', 'E10.8',
    'E11.0', 'E11.1', 'E11.2', 'E11.3', 'E11.4', 'E11.5', 'E11.6', 'E11.7', 'E11.8',
    'F01.1', 'F01.2', 'F01.3', 'F01.4', 'F01.6', 'F01.7', 'F01.8', 'F01.9',
    'I11.1', 'I11.2', 'I11.3', 'I11.4', 'I11.5', 'I11.6', 'I11.7', 'I11.8',
    'I13.1', 'I13.3', 'I13.4', 'I13.5', 'I13.6', 'I13.7', 'I13.8', 'I13.9',
    'I21.3', 'I21.4', 'I21.5', 'I21.6', 'I21.7', 'I21.8', 'I21.9',
    'I25.0', 'I25.2', 'I25.3', 'I25.4', 'I25.5', 'I25.6', 'I25.7', 'I25.8', 'I25.9',
    'I60.1', 'I60.2', 'I60.3', 'I60.4', 'I60.5', 'I60.6', 'I60.7', 'I60.8', 'I60.9',
    'I61.1', 'I61.2', 'I61.3', 'I61.4', 'I61.5', 'I61.6', 'I61.7', 'I61.8', 'I61.9',
    'I63.1', 'I63.2', 'I63.3', 'I63.4', 'I63.5', 'I63.6', 'I63.7', 'I63.8', 'I63.9',
    'J44.2', 'J44.3', 'J44.4', 'J44.5', 'J44.6', 'J44.7', 'J44.8',
    'J45.0', 'J45.1', 'J45.2', 'J45.3', 'J45.4', 'J45.5', 'J45.6', 'J45.7', 'J45.8'
}

# Function to assign rank
def assign_rank_4(icd_code):
    if icd_code in nonspecific_full:
        return 1
    elif icd_code in specific_full:
        return 3
    else:
        return 2

# Function to map notes
def note_rank(rank):
    return {
        1: "Nonspecific contributing cause",
        2: "Moderately informative",
        3: "Specific and useful contributing cause"
    }[rank]

# Apply classification
df_4["usefulness_rank"] = df_4["icd10_code"].apply(assign_rank_4)
df_4["note"] = df_4["usefulness_rank"].map(note_rank)

# Save to CSV
output_path = Path("/Users/amymann/Documents/Data Quality Project/data_quality/contributing_cause_usefulness.csv")
df_4.to_csv(output_path, index=False)
